#!/usr/bin/env bash

# bin/compile <build-dir> <cache-dir>

debug_dir ()
{
    echo Directory: $1=$2
    ls -la $2
}

set -e

BUILD_DIR=$1
CACHE_DIR=$2
LP_DIR=`cd $(dirname $0); cd ..; pwd`

pwd; ls -la

cd $BUILD_DIR

pwd; ls -la

if [ -f "Makefile" ]; then
    echo "-----> Makefile found"

    debug_dir BUILD_DIR ${BUILD_DIR}
    debug_dir CACHE_DIR ${CACHE_DIR}

    make CACHE_DIR=$CACHE_DIR

    echo "-----> Compilation done"
else
    echo "-----> No Makefile found.Compilation cannot continue."
    exit 1
fi
